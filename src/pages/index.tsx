import type {NextPage} from "next";
import Head from "next/head";

import CustomHeader from "../components/CustomHeader";

import Container from "@mui/material/Container";

import HomePageItem from "../components/HomePageItem/HomePageItem";
import MostRequestedBets from "../components/MostRequestedBets/MostRequestedBets";
import SearchBets from "../components/SearchBets";

import {ThemeProvider} from "@mui/material/styles";
import BetCardProps from "../models/Bet";
import {useEffect, useState} from "react";
import CreateBet from "../components/CreateBetButton";
import {HttpClient} from "../core/http-client-adapter";
import Bet from "../models/Bet";


const Home: NextPage = () => {

    const [listSize, setListSize] = useState(6);
    const [mostRequestedBets, setMostRequestedBets] = useState<Bet[]>([]);

    const seeMoreHandler = () => {
        setListSize(listSize + 5);
    }

    const fetchBets = async () => {
        const http = new HttpClient();
        return await http.get<Bet[]>("api/bets");
    };

    useEffect(() => {
        fetchBets().then((bets) => {
            setMostRequestedBets(bets);
        })
    }, []);


    return (
        <div>
            <Head>
                <title>Matchingbet</title>
                <meta name="description" content="Generated by create next app"/>
                <link rel="icon" href="/favicon.ico"/>
            </Head>

            <CustomHeader/>
            <Container>
                <HomePageItem title="Buscar Apostas">
                    <SearchBets/>
                </HomePageItem>

                <HomePageItem
                    title="Apostas mais acessadas"
                    showSeeMore={true}
                    seeMoreHandler={seeMoreHandler}
                >
                    <MostRequestedBets mostRequestedBets={mostRequestedBets} size={listSize}/>
                </HomePageItem>
            </Container>

            <CreateBet/>
        </div>
    );
};

export default Home;
